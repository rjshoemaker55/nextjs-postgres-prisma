{"ast":null,"code":"var _jsxFileName = \"/Users/rjshoemaker/Documents/code/practice/nextjs-postgres-prisma/blogr-nextjs-prisma/pages/drafts.tsx\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport Layout from '../components/Layout';\nimport Post from '../components/Post';\nimport { useSession, getSession } from 'next-auth/client';\nimport prisma from '../lib/prisma';\nexport const getServerSideProps = async ({\n  req,\n  res\n}) => {\n  const session = await getSession({\n    req\n  });\n\n  if (!session) {\n    res.statusCode = 403;\n    return {\n      props: {\n        drafts: []\n      }\n    };\n  }\n\n  const drafts = await prisma.post.findMany({\n    where: {\n      author: {\n        email: session.user.email\n      },\n      published: false\n    },\n    include: {\n      author: {\n        select: {\n          name: true\n        }\n      }\n    }\n  });\n  return {\n    props: {\n      drafts\n    }\n  };\n};\n\nconst Drafts = props => {\n  const [session] = useSession();\n\n  if (!session) {\n    return __jsx(Layout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 7\n      }\n    }, __jsx(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 9\n      }\n    }, \"My Drafts\"), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 9\n      }\n    }, \"You need to be authenticated to view this page.\"));\n  }\n\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-1536480903\" + \" \" + 'page',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }\n  }, __jsx(\"h1\", {\n    className: \"jsx-1536480903\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }\n  }, \"My Drafts\"), __jsx(\"main\", {\n    className: \"jsx-1536480903\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, props.drafts.map(post => __jsx(\"div\", {\n    key: post.id,\n    className: \"jsx-1536480903\" + \" \" + 'post',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }\n  }, __jsx(Post, {\n    post: post,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 15\n    }\n  }))))), __jsx(_JSXStyle, {\n    id: \"1536480903\",\n    __self: this\n  }, \".post.jsx-1536480903{background:var(--geist-background);-webkit-transition:box-shadow 0.1s ease-in;transition:box-shadow 0.1s ease-in;}.post.jsx-1536480903:hover{box-shadow:1px 1px 3px #aaa;}.post.jsx-1536480903+.post.jsx-1536480903{margin-top:2rem;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yanNob2VtYWtlci9Eb2N1bWVudHMvY29kZS9wcmFjdGljZS9uZXh0anMtcG9zdGdyZXMtcHJpc21hL2Jsb2dyLW5leHRqcy1wcmlzbWEvcGFnZXMvZHJhZnRzLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxRGtCLEFBRzhDLEFBS1AsQUFJWixnQkFDbEIsWUFKQSxPQUxxQyw4RUFDckMiLCJmaWxlIjoiL1VzZXJzL3Jqc2hvZW1ha2VyL0RvY3VtZW50cy9jb2RlL3ByYWN0aWNlL25leHRqcy1wb3N0Z3Jlcy1wcmlzbWEvYmxvZ3ItbmV4dGpzLXByaXNtYS9wYWdlcy9kcmFmdHMudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgR2V0U2VydmVyU2lkZVByb3BzIH0gZnJvbSAnbmV4dCdcbmltcG9ydCBMYXlvdXQgZnJvbSAnLi4vY29tcG9uZW50cy9MYXlvdXQnXG5pbXBvcnQgUG9zdCwgeyBQb3N0UHJvcHMgfSBmcm9tICcuLi9jb21wb25lbnRzL1Bvc3QnXG5pbXBvcnQgeyB1c2VTZXNzaW9uLCBnZXRTZXNzaW9uLCBzZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoL2NsaWVudCdcbmltcG9ydCBwcmlzbWEgZnJvbSAnLi4vbGliL3ByaXNtYSdcblxuZXhwb3J0IGNvbnN0IGdldFNlcnZlclNpZGVQcm9wczogR2V0U2VydmVyU2lkZVByb3BzID0gYXN5bmMgKHsgcmVxLCByZXMgfSkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbih7IHJlcSB9KVxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXMuc3RhdHVzQ29kZSA9IDQwM1xuICAgIHJldHVybiB7IHByb3BzOiB7IGRyYWZ0czogW10gfSB9XG4gIH1cblxuICBjb25zdCBkcmFmdHMgPSBhd2FpdCBwcmlzbWEucG9zdC5maW5kTWFueSh7XG4gICAgd2hlcmU6IHtcbiAgICAgIGF1dGhvcjogeyBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsIH0sXG4gICAgICBwdWJsaXNoZWQ6IGZhbHNlXG4gICAgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBhdXRob3I6IHtcbiAgICAgICAgc2VsZWN0OiB7IG5hbWU6IHRydWUgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcblxuICByZXR1cm4geyBwcm9wczogeyBkcmFmdHMgfSB9XG59XG5cbmNvbnN0IERyYWZ0czogUmVhY3QuRkM8UG9zdFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCBbc2Vzc2lvbl0gPSB1c2VTZXNzaW9uKClcblxuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4gKFxuICAgICAgPExheW91dD5cbiAgICAgICAgPGgxPk15IERyYWZ0czwvaDE+XG4gICAgICAgIDxkaXY+WW91IG5lZWQgdG8gYmUgYXV0aGVudGljYXRlZCB0byB2aWV3IHRoaXMgcGFnZS48L2Rpdj5cbiAgICAgIDwvTGF5b3V0PlxuICAgIClcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPExheW91dD5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPSdwYWdlJz5cbiAgICAgICAgPGgxPk15IERyYWZ0czwvaDE+XG4gICAgICAgIDxtYWluPlxuICAgICAgICAgIHtwcm9wcy5kcmFmdHMubWFwKChwb3N0KSA9PiAoXG4gICAgICAgICAgICA8ZGl2IGtleT17cG9zdC5pZH0gY2xhc3NOYW1lPSdwb3N0Jz5cbiAgICAgICAgICAgICAgPFBvc3QgcG9zdD17cG9zdH0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkpfVxuICAgICAgICA8L21haW4+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnBvc3Qge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWdlaXN0LWJhY2tncm91bmQpO1xuICAgICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4xcyBlYXNlLWluO1xuICAgICAgICB9XG5cbiAgICAgICAgLnBvc3Q6aG92ZXIge1xuICAgICAgICAgIGJveC1zaGFkb3c6IDFweCAxcHggM3B4ICNhYWE7XG4gICAgICAgIH1cblxuICAgICAgICAucG9zdCArIC5wb3N0IHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAycmVtO1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9MYXlvdXQ+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgRHJhZnRzXG4iXX0= */\\n/*@ sourceURL=/Users/rjshoemaker/Documents/code/practice/nextjs-postgres-prisma/blogr-nextjs-prisma/pages/drafts.tsx */\"));\n};\n\nexport default Drafts;","map":{"version":3,"sources":["/Users/rjshoemaker/Documents/code/practice/nextjs-postgres-prisma/blogr-nextjs-prisma/pages/drafts.tsx"],"names":["React","Layout","Post","useSession","getSession","prisma","getServerSideProps","req","res","session","statusCode","props","drafts","post","findMany","where","author","email","user","published","include","select","name","Drafts","map","id"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,IAAP,MAAgC,oBAAhC;AACA,SAASC,UAAT,EAAqBC,UAArB,QAAgD,kBAAhD;AACA,OAAOC,MAAP,MAAmB,eAAnB;AAEA,OAAO,MAAMC,kBAAsC,GAAG,OAAO;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAP,KAAwB;AAC5E,QAAMC,OAAO,GAAG,MAAML,UAAU,CAAC;AAAEG,IAAAA;AAAF,GAAD,CAAhC;;AACA,MAAI,CAACE,OAAL,EAAc;AACZD,IAAAA,GAAG,CAACE,UAAJ,GAAiB,GAAjB;AACA,WAAO;AAAEC,MAAAA,KAAK,EAAE;AAAEC,QAAAA,MAAM,EAAE;AAAV;AAAT,KAAP;AACD;;AAED,QAAMA,MAAM,GAAG,MAAMP,MAAM,CAACQ,IAAP,CAAYC,QAAZ,CAAqB;AACxCC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAE;AAAEC,QAAAA,KAAK,EAAER,OAAO,CAACS,IAAR,CAAaD;AAAtB,OADH;AAELE,MAAAA,SAAS,EAAE;AAFN,KADiC;AAKxCC,IAAAA,OAAO,EAAE;AACPJ,MAAAA,MAAM,EAAE;AACNK,QAAAA,MAAM,EAAE;AAAEC,UAAAA,IAAI,EAAE;AAAR;AADF;AADD;AAL+B,GAArB,CAArB;AAYA,SAAO;AAAEX,IAAAA,KAAK,EAAE;AAAEC,MAAAA;AAAF;AAAT,GAAP;AACD,CApBM;;AAsBP,MAAMW,MAA2B,GAAIZ,KAAD,IAAW;AAC7C,QAAM,CAACF,OAAD,IAAYN,UAAU,EAA5B;;AAEA,MAAI,CAACM,OAAL,EAAc;AACZ,WACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yDAFF,CADF;AAMD;;AAED,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA,wCAAe,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGE,KAAK,CAACC,MAAN,CAAaY,GAAb,CAAkBX,IAAD,IAChB;AAAK,IAAA,GAAG,EAAEA,IAAI,CAACY,EAAf;AAAA,wCAA6B,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAM,IAAA,IAAI,EAAEZ,IAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADD,CADH,CAFF,CADF;AAAA;AAAA;AAAA,6iGADF;AA4BD,CAxCD;;AA0CA,eAAeU,MAAf","sourcesContent":["import React from 'react'\nimport { GetServerSideProps } from 'next'\nimport Layout from '../components/Layout'\nimport Post, { PostProps } from '../components/Post'\nimport { useSession, getSession, session } from 'next-auth/client'\nimport prisma from '../lib/prisma'\n\nexport const getServerSideProps: GetServerSideProps = async ({ req, res }) => {\n  const session = await getSession({ req })\n  if (!session) {\n    res.statusCode = 403\n    return { props: { drafts: [] } }\n  }\n\n  const drafts = await prisma.post.findMany({\n    where: {\n      author: { email: session.user.email },\n      published: false\n    },\n    include: {\n      author: {\n        select: { name: true }\n      }\n    }\n  })\n\n  return { props: { drafts } }\n}\n\nconst Drafts: React.FC<PostProps> = (props) => {\n  const [session] = useSession()\n\n  if (!session) {\n    return (\n      <Layout>\n        <h1>My Drafts</h1>\n        <div>You need to be authenticated to view this page.</div>\n      </Layout>\n    )\n  }\n\n  return (\n    <Layout>\n      <div className='page'>\n        <h1>My Drafts</h1>\n        <main>\n          {props.drafts.map((post) => (\n            <div key={post.id} className='post'>\n              <Post post={post} />\n            </div>\n          ))}\n        </main>\n      </div>\n      <style jsx>{`\n        .post {\n          background: var(--geist-background);\n          transition: box-shadow 0.1s ease-in;\n        }\n\n        .post:hover {\n          box-shadow: 1px 1px 3px #aaa;\n        }\n\n        .post + .post {\n          margin-top: 2rem;\n        }\n      `}</style>\n    </Layout>\n  )\n}\n\nexport default Drafts\n"]},"metadata":{},"sourceType":"module"}